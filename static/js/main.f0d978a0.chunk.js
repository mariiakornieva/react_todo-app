(this["webpackJsonpreact_todo-app"]=this["webpackJsonpreact_todo-app"]||[]).push([[0],{23:function(e,t,n){e.exports=n(37)},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(19),o=n.n(r),l=n(7),u=(n(28),n(29),n(30),n(6)),i=n(22),s=function(e){return{type:"RESET",todos:e}},d=function(e){return{type:"TOGGLE",id:e}},m=function(e){return{type:"DELETE",id:e}},f=function(e,t){return{type:"ADD_TODO",id:e,title:t}},p=function(e,t){return{type:"UPDATE_TODO",id:e,title:t}};function E(e,t){switch(t.type){case"RESET":return t.todos.map((function(e){return{id:e.id,title:e.title,completed:e.completed}}));case"TOGGLE":return e.map((function(e){return e.id!==t.id?e:{id:t.id,title:e.title,completed:!e.completed}}));case"DELETE":return e.filter((function(e){return e.id!==t.id}));case"TOGGLE_ALL":return e.every((function(e){return e.completed}))||e.every((function(e){return!e.completed}))?e.map((function(e){return{id:e.id,title:e.title,completed:!e.completed}})):e.map((function(e){return{id:e.id,title:e.title,completed:!0}}));case"ADD_TODO":return[].concat(Object(i.a)(e),[{id:t.id,title:t.title,completed:!1}]);case"DELETE_COMPLETED ":return e.filter((function(e){return!e.completed}));case"UPDATE_TODO":return e.map((function(e){return e.id!==t.id?e:{id:t.id,title:t.title,completed:e.completed}}));default:return e}}var h="/",v="/active",b="/completed",O=c.a.createContext([]),g=c.a.createContext((function(){}));function C(e){var t=e.children,n=Object(a.useReducer)(E,JSON.parse(localStorage.getItem("todos"))||[]),r=Object(u.a)(n,2),o=r[0],l=r[1];return Object(a.useEffect)((function(){localStorage.setItem("todos",JSON.stringify(o))}),[o]),c.a.createElement(g.Provider,{value:l},c.a.createElement(O.Provider,{value:o},t))}C.defaultProps={children:null};var y=n(9),j=n.n(y),N=n(13);function x(e,t){return fetch("".concat("https://mate-api.herokuapp.com").concat(e),t).then((function(e){if(!e.ok)throw new Error("Received response ".concat(e.status,": ").concat(e.statusText));return e.json()})).then((function(e){return e.data})).catch((function(e){throw new Error("".concat(e," occurred"))}))}var k=function(e){return x("/todos/".concat(e),{method:"DELETE"})},D=function(e,t){return x("/todos/".concat(e),{method:"PATCH",body:JSON.stringify({completed:t})})};function T(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useContext)(g);return c.a.createElement("form",{onSubmit:function(e){var t,a;e.preventDefault(),n.trim()&&((t=1189,a=n.trim(),x("/todos",{method:"POST",body:JSON.stringify({userId:t,title:a,completed:!1})})).then((function(e){o(f(e.id,e.title))})).catch((function(e){return alert(e)})),r(""))}},c.a.createElement("input",{value:n,onChange:function(e){return r(e.target.value)},type:"text",className:"new-todo",placeholder:"What needs to be done?"}))}var S=n(1),w=n(20),P=n.n(w);function A(e){var t=e.id,n=e.title,r=e.completed,o=Object(a.useState)(n),l=Object(u.a)(o,2),i=l[0],s=l[1],f=Object(a.useState)(!1),E=Object(u.a)(f,2),h=E[0],v=E[1],b=Object(a.useContext)(g),O=function(){if(i!==n){var e=n;b(p(t,i)),v(!1),function(e,t){return x("/todos/".concat(e),{method:"PATCH",body:JSON.stringify({title:t})})}(t,i).catch((function(){b(p(t,e)),s(e)}))}};return c.a.createElement("li",{className:P()({completed:r,editing:h})},c.a.createElement("div",{className:"view"},c.a.createElement("input",{type:"checkbox",className:"toggle",checked:r,onChange:function(){D(t,!r).then((function(){return b(d(t))})).catch((function(e){return alert("Failed to toggle item ".concat(n,"; ").concat(e))}))}}),c.a.createElement("label",{onDoubleClick:function(){return v(!0)}},n),c.a.createElement("button",{type:"button",className:"destroy",onClick:function(){k(t).then((function(){return b(m(t))})).catch((function(e){return alert("Failed to delete item ".concat(n,"; ").concat(e))}))}})),c.a.createElement("input",{type:"text",className:"edit",value:i,onChange:function(e){return s(e.target.value)},onBlur:O,onKeyDown:function(e){switch(e.key){case"Enter":O();break;case"Escape":s(n),v(!1)}}}))}function L(){var e=Object(a.useContext)(O),t=Object(a.useContext)(g),n=Object(S.d)().pathname,r=Object(a.useMemo)((function(){return e.filter((function(e){var t=e.completed;switch(n){case v:return!t;case b:return t;case h:default:return!0}}))}),[e,n]),o=Object(a.useMemo)((function(){return e.every((function(e){return e.completed}))}),[e]),l=function(){var n=Object(N.a)(j.a.mark((function n(){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!o&&!e.every((function(e){return!e.completed}))){n.next=6;break}return n.next=3,Promise.allSettled(e.map((function(e){return D(e.id,!e.completed)})));case 3:a=n.sent,n.next=9;break;case 6:return n.next=8,Promise.allSettled(e.filter((function(e){return!e.completed})).map((function(e){return D(e.id,!0)})));case 8:a=n.sent;case 9:a.forEach((function(e){"fulfilled"===e.status?t(d(e.value.id)):alert("Failed to toggle item")}));case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return c.a.createElement("section",{className:"main"},e.length>0&&c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{type:"checkbox",id:"toggle-all",className:"toggle-all",checked:o,onChange:l}),c.a.createElement("label",{htmlFor:"toggle-all"},"Mark all as complete")),c.a.createElement("ul",{className:"todo-list"},r.map((function(e){return c.a.createElement(A,Object.assign({key:e.id},e))}))))}function F(e){var t=e.handleDeleteCompleted,n=e.activeCount,a=e.completedCount;return c.a.createElement("footer",{className:"footer"},c.a.createElement("span",{className:"todo-count"},"".concat(n," items left")),c.a.createElement("ul",{className:"filters"},c.a.createElement("li",null,c.a.createElement(l.b,{to:"/",exact:!0,activeClassName:"selected"},"All")),c.a.createElement("li",null,c.a.createElement(l.b,{to:"/active",activeClassName:"selected"},"Active")),c.a.createElement("li",null,c.a.createElement(l.b,{to:"/completed",activeClassName:"selected"},"Completed"))),a>0&&c.a.createElement("button",{type:"button",className:"clear-completed",onClick:t},"Clear completed"))}function _(e){var t=e.name;return c.a.createElement("h2",null,t)}A.defaultProps={title:"",completed:!1},L.defaultProps={todos:[],toggleAllChecked:!1},F.defaultProps={activeCount:0,completedCount:0},_.defaultProps={name:"user name"};var J=function(){var e=Object(a.useContext)(O),t=Object(a.useContext)(g),n=Object(a.useState)({}),r=Object(u.a)(n,2),o=r[0],l=r[1];Object(a.useEffect)((function(){var e;(e=1189,x("/users/".concat(e))).then(l).catch((function(e){return alert("Failed to fetch user data; ".concat(e))})),function(e){return x("/todos?userId=".concat(e))}(1189).then((function(e){return t(s(e))})).catch((function(e){return alert("Failed to fetch todo list; ".concat(e))}))}),[]);var i=Object(a.useMemo)((function(){var t=e.filter((function(e){return e.completed})).length;return[e.length-t,t]}),[e]),d=Object(u.a)(i,2),f=d[0],p=d[1],E=function(){var n=Object(N.a)(j.a.mark((function n(){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.allSettled(e.filter((function(e){return e.completed})).map((function(e){return k(e.id)})));case 2:n.sent.forEach((function(e){"fulfilled"===e.status?t(m(e.value.id)):alert("Failed to delete item")}));case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"todoapp"},c.a.createElement("header",{className:"header"},c.a.createElement("h1",null,"todos"),c.a.createElement(T,null)),c.a.createElement(L,null),e.length>0&&c.a.createElement(F,{activeCount:f,completedCount:p,handleDeleteCompleted:E})),c.a.createElement(_,{name:o.name}))};o.a.render(c.a.createElement(l.a,null,c.a.createElement(C,null,c.a.createElement(J,null))),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.f0d978a0.chunk.js.map